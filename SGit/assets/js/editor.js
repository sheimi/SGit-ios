// Generated by CoffeeScript 1.6.3
(function() {
  var displayFileContent, editor, lang, rawCodes, requestLocal;

  String.prototype.rtrim = function() {
    return this.replace(/\s+$/, '');
  };

  requestLocal = function(request, json) {
    if (json === void 0) {
      return document.location.href = "ios://" + request;
    } else {
      return document.location.href = "ios://" + json + "/" + request;
    }
  };

  rawCodes = void 0;

  lang = void 0;

  editor = void 0;

  displayFileContent = function() {
    var editorElm, editorOption;
    $('#editor').text(rawCodes);
    editorElm = document.getElementById("editor");
    editorOption = {
      lineNumbers: true,
      mode: lang,
      matchBrackets: true,
      lineWrapping: true,
      readOnly: true
    };
    return editor = CodeMirror.fromTextArea(editorElm, editorOption);
  };

  window.notifyFileLoaded = function() {
    return displayFileContent();
  };

  window.setLanguage = function(lang) {
    return displayFileContent(lang);
  };

  window.setLang = function(l) {
    lang = l;
    if (editor) {
      return editor.setOption('mode', lang);
    }
  };

  window.setRawCodes = function(raw) {
    return rawCodes = raw;
  };

  window.display = displayFileContent;

  window.setEditable = function() {
    return editor.setOption("readOnly", false);
  };

  window.save = function() {
    var value;
    editor.setOption("readOnly", true);
    value = editor.getValue().rtrim();
    return value;
  };

  $(document).ready(function() {
    return requestLocal('init');
  });

}).call(this);
